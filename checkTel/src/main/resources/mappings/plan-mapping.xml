<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="PlanDAO"> <!--namespace로 구분  -->

	<resultMap id="planResult" type="plan"> <!--type에는 클래스 명  -->
		<id property="planNo" column="PLAN_NO"/> <!--필드명(planVO 필드), 컬럼명  -->
		<id property="planPeriod" column="PLAN_PERIOD" />
		<id property="memberNo" column="MEMBER_NO" />
		<id property="blogHit" column="BLOG_HIT" />
		<result property="planStart" column="PLAN_START" />
		<result property="planEnd" column="PLAN_END" />
		<result property="blogTitle" column="BLOG_TITLE" />
	</resultMap>
   
   <insert id="insertPlan" parameterType="plan">
      <selectKey keyProperty="planNo" resultType="int" order="BEFORE">
      	SELECT NVL(MAX(PLAN_NO), 0) + 1 FROM PLAN
      </selectKey>
      <!-- CDATA 태그인식을 막는 명령어 -->
      INSERT INTO PLAN(
      				  PLAN_NO
      				, PLAN_PERIOD
      				, PLAN_START
      				, PLAN_END
      				, MEMBER_NO
      				, BLOG_HIT
      				, BLOG_TITLE)
      VALUES(
      	  #{planNo}
      	, #{planPeriod}
      	, #{planStart}
      	, #{planEnd}
      	, #{memberNo}
      	, #{blogHit}
      	, #{blogTitle})
   </insert>
   
   	<select id="getPlan" resultMap="planResult">
        <![CDATA[
        SELECT * 
        FROM PLAN
        WHERE PLAN_NO = #{planNo}
        ]]>
	</select>

</mapper>
